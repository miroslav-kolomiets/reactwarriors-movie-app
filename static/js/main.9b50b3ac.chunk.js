(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{26:function(e,t,a){e.exports=a(55)},54:function(e,t,a){},55:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(11),o=a.n(s),i=a(10),c=a(13),l=a(3),u=a(4),p=a(6),m=a(5),h=a(7),d=function(e){function t(){return Object(l.a)(this,t),Object(p.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.user;return r.a.createElement("div",null,r.a.createElement("img",{width:"40",className:"rounded-circle",src:"https://secure.gravatar.com/avatar/".concat(e.avatar.gravatar.hash,'.jpg?s=64"'),alt:"avatar"}))}}]),t}(r.a.Component),g=a(58),b=a(56),v="https://api.themoviedb.org/3",f="5265606bb69e99437c85eb04dc6f29b5",y=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(function(a,n){fetch(e,t).then(function(e){if(e.status<400)return e.json();throw e}).then(function(e){a(e)}).catch(function(e){e.json().then(function(e){n(e)})})})},j=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(p.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={username:"",password:"",repeatPassword:"",errors:{},submitting:!1},a.onChange=function(e){var t=e.target.name,n=e.target.value;a.setState(Object(i.a)({},t,n))},a.handleBlur=function(e){var t=a.validateFields(),n=e.target.name;t[n]&&a.setState(function(e){return{errors:Object(c.a)({},e.errors,Object(i.a)({},n,t[n]))}})},a.validateFields=function(){var e={};return""===a.state.username&&(e.username="Not empty"),""===a.state.password&&(e.password="Not empty"),""===a.state.repeatPassword&&(e.repeatPassword="Not empty"),a.state.repeatPassword!==a.state.password&&(e.repeatPassword="Mast be equal for password"),e},a.onSubmit=function(){a.setState({submitting:!0}),y("".concat(v,"/authentication/token/new?api_key=").concat(f)).then(function(e){return y("".concat(v,"/authentication/token/validate_with_login?api_key=").concat(f),{method:"POST",mode:"cors",headers:{"Content-type":"application/json"},body:JSON.stringify({username:a.state.username,password:a.state.password,request_token:e.request_token})})}).then(function(e){return y("".concat(v,"/authentication/session/new?api_key=").concat(f),{method:"POST",mode:"cors",headers:{"Content-type":"application/json"},body:JSON.stringify({request_token:e.request_token})})}).then(function(e){return a.props.updateSessionId(e.session_id),y("".concat(v,"/account?api_key=").concat(f,"&session_id=").concat(e.session_id))}).then(function(e){console.log("session",e),a.props.updateUser(e),a.setState({submitting:!1})}).catch(function(e){console.log("error",e),a.setState({submitting:!1,errors:{base:e.status_message}})})},a.onLogin=function(e){e.preventDefault();var t=a.validateFields();Object.keys(t).length>0?a.setState(function(e){return{errors:Object(c.a)({},e.errors,t)}}):a.onSubmit()},a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.state,t=e.username,a=e.password,n=e.repeatPassword,s=e.errors,o=e.submitting;return r.a.createElement("div",{className:"form-login-container"},r.a.createElement("form",{className:"form-login"},r.a.createElement("h1",{className:"h3 mb-3 font-weight-normal text-center"},"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f"),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"username"},"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c"),r.a.createElement("input",{type:"text",className:s.username?"form-control is-invalid":"form-control",id:"username",placeholder:"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c",name:"username",value:t,onChange:this.onChange,onBlur:this.handleBlur}),s.username&&r.a.createElement("div",{className:"invalid-feedback"},s.username)),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"password"},"\u041f\u0430\u0440\u043e\u043b\u044c"),r.a.createElement("input",{type:"password",className:s.password?"form-control is-invalid":"form-control",id:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",name:"password",value:a,onChange:this.onChange,onBlur:this.handleBlur}),s.password&&r.a.createElement("div",{className:"invalid-feedback"},s.password)),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"repeatPassword"},"\u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c"),r.a.createElement("input",{type:"password",className:s.repeatPassword?"form-control is-invalid":"form-control",id:"repeatPassword",placeholder:"\u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c",name:"repeatPassword",value:n,onChange:this.onChange,onBlur:this.handleBlur}),s.repeatPassword&&r.a.createElement("div",{className:"invalid-feedback"},s.repeatPassword)),r.a.createElement("button",{type:"submit",className:"btn btn-lg btn-primary btn-block",onClick:this.onLogin,disabled:o},"\u0412\u0445\u043e\u0434"),s.base&&r.a.createElement("div",{className:"invalid-feedback text-center"},s.base)))}}]),t}(r.a.Component),E=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this))).toggleModal=function(){e.setState(function(e){return{showModal:!e.showModal}})},e.state={showModal:!1},e}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("button",{className:"btn btn-success",type:"button",onClick:this.toggleModal},"Login"),r.a.createElement(g.a,{isOpen:this.state.showModal,toggle:this.toggleModal},r.a.createElement(b.a,null,r.a.createElement(j,{updateUser:this.props.updateUser,updateSessionId:this.props.updateSessionId}))))}}]),t}(r.a.Component),O=function(e){function t(){return Object(l.a)(this,t),Object(p.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.user,a=e.updateUser;return r.a.createElement("nav",{className:"navbar navbar-dark bg-primary"},r.a.createElement("div",{className:"container"},r.a.createElement("ul",{className:"navbar-nav"},r.a.createElement("li",{className:"nav-item active"},r.a.createElement("a",{className:"nav-link",href:"/"},"Home"))),t?r.a.createElement(d,{user:t}):r.a.createElement(E,{updateUser:a,updateSessionId:this.props.updateSessionId})))}}]),t}(r.a.Component),_=function(e){function t(){return Object(l.a)(this,t),Object(p.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.sort_by,a=e.onChangeFilters,n=e.options;return r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"sort_by"},"\u0421\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e:"),r.a.createElement("select",{className:"form-control",id:"sort_by",name:"sort_by",value:t,onChange:a},n.map(function(e){return r.a.createElement("option",{key:e.value,value:e.value},e.label)})))}}]),t}(r.a.Component);_.defaultProps={options:[{label:"\u041f\u043e\u043f\u0443\u043b\u044f\u0440\u043d\u044b\u0435 \u043f\u043e \u0443\u0431\u044b\u0432\u0430\u043d\u0438\u044e",value:"popularity.desc"},{label:"\u041f\u043e\u043f\u0443\u043b\u044f\u0440\u043d\u044b\u0435 \u043f\u043e \u0432\u043e\u0437\u0440\u043e\u0441\u0442\u0430\u043d\u0438\u044e",value:"popularity.asc"},{label:"\u0420\u0435\u0439\u0442\u0438\u043d\u0433 \u043f\u043e \u0443\u0431\u044b\u0432\u0430\u043d\u0438\u044e",value:"vote_average.desc"},{label:"\u0420\u0435\u0439\u0442\u0438\u043d\u0433 \u043f\u043e \u0432\u043e\u0437\u0440\u043e\u0441\u0442\u0430\u043d\u0438\u044e",value:"vote_average.asc"}]};var w=a(23),k=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this))).onChangeGenresFilters=function(t){var a=t.target.value,n=t.target.name,r=e.props.with_genres;e.props.onChangeFilters({target:{name:n,value:r.includes(a)?r.filter(function(e){return e!==a}):[].concat(Object(w.a)(r),[a])}})},e.getGenres=function(){var t="".concat(v,"/genre/movie/list?api_key=").concat(f,"&language=en-US");fetch(t).then(function(e){return e.json()}).then(function(t){e.setState({genres:t.genres})})},e.state={genres:[]},e}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.getGenres()}},{key:"render",value:function(){var e=this,t=this.state.genres;return r.a.createElement("div",null,t.map(function(t){return r.a.createElement("div",{className:"form-check",key:t.id},r.a.createElement("input",{className:"form-check-input",type:"checkbox",onChange:e.onChangeGenresFilters,name:"with_genres",value:t.id,checked:e.props.with_genres.includes(t.id.toString()),id:t.id}),r.a.createElement("label",{className:"form-check-label",htmlFor:"defaultCheck1"},t.name))}))}}]),t}(r.a.Component),N=(new Date).getFullYear(),C=Array.from(new Array(20),function(e,t){return N-t}),F=function(e){function t(){return Object(l.a)(this,t),Object(p.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.primary_release_year,a=e.onChangeFilters;return r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"primary_release_year"},"\u0413\u043e\u0434 \u0432\u044b\u043f\u0443\u0441\u043a\u0430:"),r.a.createElement("select",{className:"form-control",id:"primary_release_year",name:"primary_release_year",value:t,onChange:a},C.map(function(e){return r.a.createElement("option",{key:e,value:e},e)})))}}]),t}(r.a.Component),S=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(p.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).paginationBack=function(){var e=a.props;return(0,e.onChangePagination)({name:"page",value:e.page-1})},a.paginationForward=function(){var e=a.props;return(0,e.onChangePagination)({name:"page",value:e.page+1})},a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.page,a=e.total_pages;return r.a.createElement("div",null,r.a.createElement("div",{className:"btn-group btn-block",role:"group","aria-label":"Basic example"},r.a.createElement("button",{type:"button",className:"btn btn-light",disabled:1===t,onClick:this.paginationBack},"\u041d\u0430\u0437\u0430\u0434"),r.a.createElement("button",{type:"button",className:"btn btn-light",onClick:this.paginationForward},"\u0412\u043f\u0435\u0440\u0435\u0434")),r.a.createElement("p",{className:"text-center p-3 text-center"},"".concat(t," \u0438\u0437 ").concat(a)))}}]),t}(r.a.Component),P=function(e){function t(){return Object(l.a)(this,t),Object(p.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"btn-group btn-block",role:"group","aria-label":"Basic example"},r.a.createElement("button",{type:"button",className:"btn btn-light btn-block",onClick:this.props.resetFilters},"\u0421\u0431\u0440\u043e\u0441\u0438\u0442\u044c \u0444\u0438\u043b\u044c\u0442\u0440\u044b"))}}]),t}(r.a.Component),M=function(e){function t(){return Object(l.a)(this,t),Object(p.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.filters,a=t.sort_by,n=t.primary_release_year,s=t.with_genres,o=e.pagination,i=o.page,c=o.total_pages,l=e.onChangePagination,u=e.resetFilters,p=e.onChangeFilters;return r.a.createElement("form",{className:"mb-3"},r.a.createElement(_,{sort_by:a,onChangeFilters:p}),r.a.createElement(F,{primary_release_year:n,onChangeFilters:p}),r.a.createElement(k,{with_genres:s,onChangeFilters:p}),r.a.createElement(S,{onChangePagination:l,total_pages:c,page:i}),r.a.createElement(P,{resetFilters:u}))}}]),t}(r.a.Component),x=a(21),B=a.n(x),U=a(22),I=a.n(U),q=function(e){function t(){return Object(l.a)(this,t),Object(p.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.item;return r.a.createElement("div",{className:"card",style:{width:"100%"}},r.a.createElement("img",{className:"card-img-top card-img--height",src:"https://image.tmdb.org/t/p/w500".concat(e.backdrop_path||e.poster_path),alt:""}),r.a.createElement("div",{className:"card-body"},r.a.createElement("h6",{className:"card-title"},e.title),r.a.createElement("div",{className:"card-text"},"\u0420\u0435\u0439\u0442\u0438\u043d\u0433: ",e.vote_average),r.a.createElement("div",{className:"card-text"},"\u0420\u0435\u043b\u0438\u0437: ",e.release_date)))}}]),t}(r.a.Component),D=a(57),A=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this))).getMovies=function(t,a){var n=t.sort_by,r=t.primary_release_year,s=t.with_genres,o=a.page,i={api_key:f,sort_by:n,page:o,primary_release_year:r,with_genres:s,language:"ru-RU"},c=I.a.stringify(i),l="".concat(v,"/discover/movie?").concat(c);fetch(l).then(function(e){return e.json()}).then(function(t){e.setState({movies:t.results}),e.props.onChangePagination({name:"total_pages",value:t.total_pages})})},e.state={movies:[]},e}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.getMovies(this.props.filters,this.props.pagination)}},{key:"componentDidUpdate",value:function(e){B.a.isEqual(this.props.filters,e.filters)||(this.getMovies(this.props.filters,1),this.props.onChangePagination(1)),this.props.pagination.page!==e.pagination.page&&this.getMovies(this.props.filters,this.props.pagination)}},{key:"render",value:function(){var e=this.state.movies;return r.a.createElement("div",null,r.a.createElement("div",{className:"loader-wrapper"},0===e.length&&r.a.createElement(D.a,{color:"primary"})),r.a.createElement("div",{className:"row"},e.map(function(e){return r.a.createElement("div",{key:e.id,className:"col-6 mb-4"},r.a.createElement(q,{item:e}))})))}}]),t}(n.Component),G=new(a(24).a),J=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this))).updateUser=function(t){e.setState({user:t})},e.updateSessionId=function(t){G.set("session_id",t,{path:"/",maxAge:2592e3}),e.setState({session_id:t})},e.onChangeFilters=function(t){var a=t.target.name,n=t.target.value,r=Object(c.a)({},e.state.filters,Object(i.a)({},a,n));e.setState({filters:r})},e.resetFilters=function(){e.setState(function(e){return{filters:{sort_by:"popularity.desc",primary_release_year:"",with_genres:[]},pagination:{page:1,total_pages:0}}})},e.onChangePagination=function(t){var a=t.name,n=t.value;e.setState(function(e){return{pagination:Object(c.a)({},e.pagination,Object(i.a)({},a,n))}})},e.state={user:null,session_id:null,filters:{sort_by:"popularity.desc",primary_release_year:"",with_genres:[]},pagination:{page:1,total_pages:0}},e}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=G.get("session_id");t&&y("".concat(v,"/account?api_key=").concat(f,"&session_id=").concat(t)).then(function(t){e.updateUser(t)})}},{key:"render",value:function(){var e=this.state,t=e.filters,a=e.pagination,n=e.page,s=e.total_pages,o=e.user;return r.a.createElement("div",null,r.a.createElement(O,{updateUser:this.updateUser,updateSessionId:this.updateSessionId,user:o}),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row mt-4"},r.a.createElement("div",{className:"col-4"},r.a.createElement("div",{className:"card",style:{width:"100%"}},r.a.createElement("div",{className:"card-body"},r.a.createElement("h3",null,"\u0424\u0438\u043b\u044c\u0442\u0440\u044b:"),r.a.createElement(M,{page:n,total_pages:s,pagination:a,filters:t,resetFilters:this.resetFilters,onChangePagination:this.onChangePagination,onChangeFilters:this.onChangeFilters})))),r.a.createElement("div",{className:"col-8"},r.a.createElement(A,{pagination:a,movies:this.state.movies,getMovies:this.getMovies,filters:this.state.filters,onChangePagination:this.onChangePagination})))))}}]),t}(r.a.Component);a(53),a(54);o.a.render(r.a.createElement(J,null),document.getElementById("root"))}},[[26,1,2]]]);
//# sourceMappingURL=main.9b50b3ac.chunk.js.map